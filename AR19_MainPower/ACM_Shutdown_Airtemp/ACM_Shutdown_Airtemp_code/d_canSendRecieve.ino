void CanSetup() // Sets up the CAN-Bus protocol.  
{
  SPI.begin();
  mcp2515.reset();
  mcp2515.setBitrate(CAN_1000KBPS);
  mcp2515.setNormalMode();

// CAN message 0x15 - ACM OK Signal

  myMessage.can_id = 0x15;  
  myMessage.can_dlc = 1; 
  myMessage.data[0] = 21;


  mcp2515.sendMessage(&myMessage);

}


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////



void CanRecieve() {

using namespace cansignal;
//Ta imot data

// CAN message 0x410 - Breakpressure.

 if (mcp2515.readMessage(&myMessage) == MCP2515::ERROR_OK) {
  
    myMessage.can_id = 0x410;  // ID'en til meldingen som er mottat
    myMessage.can_dlc = 3; // Antal byte med data i meldingen 1 til 8
    myMessage.data[0] = breakPressure1; // Det f√∏rste bytet med data
  }



}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


void CanSend() {      // Sende data
using namespace cansignal;
// CAN message 0x20 - div

  myMessage.can_id = 0x20;  
  myMessage.can_dlc = 5; 
  myMessage.data[0] = requestBlip;
  myMessage.data[1] = 0;//engineCut
  myMessage.data[2] = 0;//clutchInSignal 
  myMessage.data[3] = gearPosition; 
  myMessage.data[4] = clutchPressure; 

  mcp2515.sendMessage(&myMessage);

}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
